Original code by mic159.

Forked by hmallen for Python3 compatibility.